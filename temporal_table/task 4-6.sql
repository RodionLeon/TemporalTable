USE OfficeExpenses
--первый квартал
SELECT *
FROM dbo.Department FOR SYSTEM_TIME AS OF '2022-03-31 23:59:59.9999999'

SELECT *
FROM dbo.Employee FOR SYSTEM_TIME AS OF '2022-03-31 23:59:59.9999999'


SELECT *
FROM dbo.ExpenseType FOR SYSTEM_TIME AS OF '2022-03-31 23:59:59.9999999'


--второй квартал
SELECT *
FROM dbo.Department FOR SYSTEM_TIME AS OF '2022-06-30 23:59:59.9999999'

SELECT *
FROM dbo.Employee FOR SYSTEM_TIME AS OF '2022-06-30 23:59:59.9999999'

SELECT *
FROM dbo.ExpenseType FOR SYSTEM_TIME AS OF '2022-06-30 23:59:59.9999999'


--третий квартал
SELECT *
FROM dbo.Department FOR SYSTEM_TIME AS OF '2022-09-30 23:59:59.9999999'

SELECT *
FROM dbo.Employee FOR SYSTEM_TIME AS OF '2022-09-30 23:59:59.9999999'

SELECT *
FROM dbo.ExpenseType FOR SYSTEM_TIME AS OF '2022-09-30 23:59:59.9999999'


--четвертый квартал
SELECT *
FROM dbo.Department FOR SYSTEM_TIME AS OF '2022-12-31 23:59:59.9999999'

SELECT *
FROM dbo.Employee FOR SYSTEM_TIME AS OF '2022-12-31 23:59:59.9999999'

SELECT *
FROM dbo.ExpenseType FOR SYSTEM_TIME AS OF '2022-12-31 23:59:59.9999999'


--лето 2022
SELECT *
FROM dbo.Department FOR SYSTEM_TIME
BETWEEN '2022-06-01 00:00:00.0000000' AND '2022-08-31 23:59:59.9999999'

SELECT *
FROM dbo.Employee FOR SYSTEM_TIME
BETWEEN '2022-06-01 00:00:00.0000000' AND '2022-08-31 23:59:59.9999999'


SELECT *
FROM dbo.ExpenseType FOR SYSTEM_TIME
BETWEEN '2022-06-01 00:00:00.0000000' AND '2022-08-31 23:59:59.9999999'


--вывести строки, которые были вставлены и удалены за третий квартал 2022 года.
SELECT *
FROM dbo.Department FOR SYSTEM_TIME CONTAINED IN ('2022-07-01','2022-09-30 23:59:59.9999999');

SELECT *
FROM dbo.Employee FOR SYSTEM_TIME CONTAINED IN ('2022-07-01','2022-09-30 23:59:59.9999999');

SELECT *
FROM dbo.ExpenseType FOR SYSTEM_TIME CONTAINED IN ('2022-07-01','2022-09-30 23:59:59.9999999');
